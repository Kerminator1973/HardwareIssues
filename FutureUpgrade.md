# Идеи о будущем Upgrade компьютера

В этом документе описываются некоторые идеи потенциального Upgrade для компьютера, а также некоторое количество слухов и домыслов, нуждающихся в проверке, но имеющиех потенциальное влияние на выбор компонентов для Upgrade.

## Intel vs AMD

В соответствии с материалами игровой прессы (в частности с английским изданием "Custom PC"), Intel и AMD выбрали разные стратегии развития своих процессоров (в статье рассмативались Intel Core 12-го поколения и AMD Ryzen 7xxx). Так, Intel фокусируется на достижении больших тактовых частот ядер, как в стандартном, так и в Boost-режимах, а AMD наращивает размер cache-памяти, в частности cache-память третьего уровня (L3), в том числе используя новые подходы в компановке чипа.

Как результат, процессоры Intel, в целом обеспечивают большую производительность на ядро, при выполнении высокоинтенсивных вычислительных операций, а процессоры AMD лучше справляются с видами нагрузки, свойственных играм, которые оказываются очень чувствительными к размеру cache-памяти процессора.

Поскольку ячейки cache-памяти сложнее и выделяют больше тепла, то процессоры AMD, обычно, гораздо более горячие, чем процессоры Intel того же поколения.

## Количество ножек процессора

Причина, по которой растёт количество контактов процессора, в первую очередь связано с количеством ядер процессора. По этой причине, маловероятно, что драматически увеличится количество производительных ядер процессора. Ещё одна причина ограниченного количества производительных ядер - сложность в отводе тепла с поверхности процессора. С высокой вероятностью, рост производительности процессоров не будет столь впечатляющим, как даже в предыдущие, не очень впечатляющие годы.

Вполне вероятно, что **big.LITTLE** будет доминировать в ближайшие годы.

## Применение памяти DDR5

Спецификации DDR5 восхитительны:

- низкое энергопотребление
- высокая тактовая частота
- широкая полоса передачи данных (с удвоением передаваемого объёма)
- в четыре раза больший объём ОЗУ, который может быть размещён на "плашке". На одной плашке DDR4 может быть 16Гб, или 32Гб (двухсторонние модули), что в совокупности даёт 128Гб ОЗУ

Однако, латентность DDR5 высокая и это минимизирует многие преимущества DDR5 по сравнению с DDR4. В синтетических тестах, DDR5 "рвёт" DDR4, но в реальных игровых замерах, разница между DDR4 и DDR5 минимальна. До тех пор, пока ценовая разница памяти является кратной, имеет смысл рассматривать качественную, брендовую память типа DDR4.

## Количество слоёв текстолита

В современных (2023 г) материнских платах чаще всего используются 6, или 8 слотов текстолита. Ориентировочно, стоимость плат с разным количеством слоёв различается в два раза. Чем больше слоёв, тем проще, в частности, изолировать линии памяти друг от друга и тем лучше работает разгон памяти. Это особенно важно для памяти DD5. Эвристическое правило: _если нужно использовать память DD5, выбирайте материнскую плату с 8 слоями текстолита_. Количество слоёв часто выводится на краю материнской плате в виде одиночной цифры.

## Развитие микропроцессоров

В 2024 году основные тренды повышения производительности процессоров:

- увеличение размера кэша - имеет ограниченный потенциал из-за транзисторного бюджета и уменьшении эффективности поиска при увеличении размера
- Hyper-Threading - добавляется дополнительный набор регистров; два виртуальных ядра нагружают один конвейер. Основная решаемая задача - простой конвейра в случае, если происходит "промах мимо кэша". Решение - пока одно виртуальное ядро простаивает, другое нагружает конвейер своими задачами. Гипотетически, по мере улучшения предсказаний и сокрашение промахов кэша, эффективность HT должна уменьшаться. Тем не менее, можно говорить о том, что в некотором общем случае, HT даёт 10-15% производительности. Однако, в случае сложных схем с P-ядрами, E-ядрами и HT, планировщик может ошибаться (выбирает не оптимальный тип ядра для решения конкретной задачи) и это может ухудшать общую производительность системы. Возможно, что по этой причине, или по причине возникновения уязвимостей (теория заговора), от использования HT постепенно стал отказываться Intel
- Использование P-ядер и E-ядер. Условно, трензисторный бюджет 4 E-ядер равен одному P-ядру. Даже не смотря на более низкую частоту E-ядер и меньших cache, этих ядер много и они дают 30-40% прибавку к общей производительности. Если не ошибается планировщик
- Добавление специализированных функций, в частности - NPU-модулей. В новых поколениях процессоров Intel начал разменивать HT на NPU. Сложно сказать, насколько это действительно размен одного на другое, т.к. по косвенной информации в публичном поле, HT требует минимум транзисторного бюджета и "режут" его либо из-за сложности и глюков планировщика, или из-за уязвимостей

Похоже на то, что:

- HT постепенно будет исчезать
- NPU будет добавляться (хотя не совсем понятно для каких задач)
- Количество P-ядер не будет рости
- Количество E-ядер, вероятно, будет рости
- Cache сильно увеличиваться не будет
- Частоты сильно увеличиваться не будут

Update июнь 2024: на выставке Computex, [специалисты Intel заявили](https://www.ixbt.com/news/2024/06/05/intel-hyper-threading-20-lunar-lake.html), что Hyper-Threading не даётся бесплатно: увеличивается вычислительный конвейер и внедряются специальные механизмы безопасности. Отключение Hyper-Threading улучшает:

- улучшению энергоэффективности
- позволяет повысить частоты функционирования процессора
- уменьшается площадь чипа

## Оценка процессоров в 2024 году

В названии процессоров очень много маркетинга. Можно было бы предположить, что седьмое поколение AMD Ryzen содержит более производительные ядра, чем пятое поколение, но в действительности, первая цифра в названии Ryzen - просто год выпуска процессора. Для примера, возьмём [характеристики разных процессоров](https://amd.news/obzor/amd-mobile/) "седьмого поколения":

- Ryzen7 7840H: Phoenix, Zen4 4nm
- Ryzen7 7745HX: Dragon Range, Zen4 5nm
- Ryzen7 7736U: Rembrandt, Zen3+ 6nm
- Ryzen7 7730U: Barcelo, Zen3 6nm
- Ryzen5 7520U: Mendocino, Zen2 6nm
- Ryzen3 7440U: Phoenix2, Zen4 4nm

Как видно из приведённого выше списка, в седьмом поколении процессоров используется четыре разных архитектуры с огромным разбросом производительности. Причём, перемешено всё очень сильно - 7440U базируется на архитектуре Zen4, тогда как 7520U на Zen2.

Однако, если посмотреть на широкопредставленные в 2024 году ноутбуке на "пятом поколении" процессоров AMD, то там ситуация тоже довольно запутанная:

- Ryzen7 5825U: Barcelo Zen3, 7nm
- Ryzen7 5800U: Cezanne Zen3, 7nm
- Ryzen5 5500U: Lucienne Zen2, 7nm

Т.е. в разных поколениях могут использоваться одинаковые архитектуры процессоров, но новые поколения содержат оптимизации архитектуры, как минимум - улучшенный техпроцесс. За счёт этого чуть подтянут Boost (~200 МГц) и базовая частота ядер (~100 МГц). Для шести ядер, дополнительные 600 МГц могут дать дополнительные 3-7% в производительности, при том же самом техпроцессе.

## Почему отключение ядер может привести к повышению производительности системы

Отключать ядра можно в BIOS/UEFI и это может оказать позитивный эффект на систему по двум причинам:

- отключение слабых ядер приводит к устранению ошибок планировщика, который будет все задачи отдавать производительным ядрам
- отлючение трети ядер может приводить к снижению нагрева и эффективному использованию Boost-а на оставшихся ядрах

Это особенно важно для ноутбуков.
