# Ошибки сборки компьютера папы

На машине установлен процессор Intel Core i5 10400. Ключевые особенности: socket FCLGA1200, PCIe 3.0.

При первоначальной сборке компьютера был не правильно установлен процессор: раньше использовался разъём PGA (_Pin Grid Array_) - у процессора были ножки, а не слоте материнской платы - разъёмы. У современных процессоров успользуется LGA (_Land Grid Array_) - на материнской плате подпружиненный контакты, а на процессоре - шариковые контакты. На старых разъёмах процессор устанавливался сверху и придавливался рычажком сверху с усилием. На современных разъёмах следует аккуратно положить процессор на площадку, добиться установки в фиксационное положение скольжением и затем без усилия закрепить процессор в разъёме с помощью рычажка. Из-за того, что процессор не был доведён до фиксационного положения и рычажок был зафиксирован с усилием, деформировалась контактная ножка в слоте процессора на материнской плате.

Деформация была найдена и грубо исправлена вручную, что дало полтора года беспроблемной эксплуатации системы.

Весной 2022 года было принято решение заменить боксовый cooler на Zalman CNPS10X PERFORMA ST (860 грамм). Кулер очень эффективно отводит тепло, но для его фиксации на LGA1200 используется переходник/адаптер с двумя местами фиксации (а не четырьмя). При установке системного блока в вертикальное положений нарушается равномерное прилегание кулера к процессору и система перестаёт работать стабильно, систематически зависая, либо не загружаясь. Было принято техническое решение - разместить системый блок в горизонтальной состоянии.

В октябре 2022 года снова начались зависания системы на старте. Анализ сбоев по индикаторам материнской платы позволил установить, что проблема связана с интегрированной видео-картой. По всей видимости, был деформирован один из контактов сокета, через который осуществляется взаимодействие встроенной в процессор GPU c материнской платой. Было принято решение установить дискретную видеокарту GeForce GTX 1060 и отключить в BIOS/UEFI интегрированную карту.

26 ноября 2023 года несколько раз возникали зависания при старте системы. Жесткая перезагрузка решала проблему. Event Log дал мутные подсказки. При выполнении команды `sfc /scannow` была идентифицирована ошибка с расхождением целостности компонентов платформы .NET. Так же в логах было указание на ошибки, связанные с утилитой Gigabyte для управления подсветкой. Указывалось, что утилиты Gigabyte не совместимы с механизмом целостности памяти, внедрённой в патчи безопасности Windows 11. Все утилиты Gigbyte были удалены. В течение нескольких следующих дней я каждый раз запускал систему и каждый день сталкивался с зависанием при первой загрузке операционной системы. Сообщения об ошибках в Event Log были разнообразными (включая нарушения контрольной суммы .NET Core). Были выполнены следующие изменения в системе:

- установлены новые драйвера материнской платы
- отключен режим быстрой загрузки
- обновлён BIOS
- обновлены драйвера видео-карты

Важно заметить, что "быстрая загрузка" действительно очень круто работает на SSD-дисках. Субьективно, компьютер загружается без "быстрой загрузки" в три раза медленнее. Если проблема с зависаниями полечится, нужно будет попробовать вернуть обратно быструю загрузку.

30 ноября 2023 года зависания продолжались, однако при анализе аппаратной конфигурации удалось выявить, что Windows не может идентифицировать и корректно проинициализировать последнее подключенное USB-устройство, который оказался USB Hub. Этот USB-хаб работает постоянно и питается не от компьютера, а от сети (он него заряжается мобильный телефон). После сброса питания хаба, он был успешно распознан Windows и следующая "холодная" загрузка успешно выполнилась.

1 декабря 2023 года система запустилась без зависаний, но с перезагрузками и последующей необходимостью восстановления файловой системы. В приложении "Windows Security" закладка "Device Security" имела иконку "Проблемы". При переходе в раздел, на экран выдавалась информация о том, что "Core Isolation" был отключен из-за наличия несовместимых драйверов. В списке несовместимых оказались драйвера для видеокамеры Logitech, датированные 2012 годом: lvbflt64.sys, lvrs64.sys и lvuvc64.sys. Для того, чтобы удалить эти драйвера можно воспользоваться командой `pnputil`, запускаемой с повышенными привилегиями.

Отобразить все сторонние драйверы можно командой:

```shell
pnputil -e
```

Команда вывела информацию о драйверах Logitech, в том числе, указав inf-файлы, связанные с этими драйверами. Для удаления драйверов были выполнены команды:

```shell
pnputil -d oem23.inf
pnputil -d oem43.inf
pnputil -d oem63.inf
```

После перезагрузки, "Device Security" позволил активировать изоляцию ядра - ошибка в этом приложении больше не выводилась.

Второе декабря - зависание на старте. В электронном журнале сообщение: "Инициализирован отчет об ошибке IOMMU". В интернете есть множество сообщений с указанием на проблему с видео-картой, или процессором/материнской картой. При попытке запуска утилиты настройки профиля работы компьютера "GIGABYTE EasyTune" получил сообщение о том, что она не работает в режиме защиты памяти и его нужно отключить. При отключении режима и повторном запуске **EasyTune** получил сообщение о том, что был нарушен профиль работы системы и его нужно восстановить. Восстановил, перезапустил систему.

Продолжаются проблемы с ESET Internet Security, который не может загрузить свои обновлённые компоненты через интернет. **UPDATE**: проблема решилась только полным удалением и переустановкой приложения. При этом пришось выполнять управление лицензиями, поскольку сервер посчитал, что устанавливаются дополнительные лицензии.

Зависания при холодном старте продолжаются. Чаще всего с этим связано следующее сообщение в системном журнале:

```log
Выполнено перечисление термальной зоны ACPI \_TZ.TZ00.             
_PSV = 0 K             
_TC1 = 0             
_TC2 = 0             
_TSP = 0 мс             
_AC0 = 344K             
_AC1 = 328 K             
_AC2 = 323 K             
_AC3 = 318 K             
_AC4 = 313 K             
_AC5 = 0 K             
_AC6 = 0 K             
_AC7 = 0 K             
_AC8 = 0 K             
_AC9 = 0 K             
_CRT = 392 K             
_HOT = 0 K             
Минимальное регулирование = 0             
_CR3 = 0 K
```

Критическая температура, при которой осуществляется выключение (_CRT)  = 392 K, т.е. она не достигается. TZ.TZ00 - это информация о микропроцессоре.

Продолжая исследовать электронный журнал, обратил внимание на следующее сообщение об ошибке: "Не удается найти описание для идентификатора события 56 из источника Application Popup. Вызывающий данное событие компонент не установлен на этом локальном компьютере или поврежден. Установите или восстановите компонент на локальном компьютере". Данная проблема обсуждается на [различных форумах](https://answers.microsoft.com/ru-ru/windows/forum/all/%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0-56-aplication/2dc2408f-489a-4bd8-9efd-4c58e558993f?page=2) и имеет отношение к приложениям App Center/EasyTune от GIGABYTE. Множество пользователей склоняется к мнению, что это приложение источник множества проблем и рекомендуют удалить его. Дополнительно пользователи рекомендуют:

- в UEFI/BIOS, в разделе Platform Power, установить параметр "Power Loading" в значение Enabled. Этот параметр позволяет избежать сбоев при работе на мылых нагрузках. Как оказывается, не все блоки питания поддерживают команды перехода в режим экономии питания и, как следствие, может нарушаться режим работы
- Не активировать режим экономии питания, используя "Сбалансированный"
- удалить все компоненты AppCenter, включая сервис OCButtonService: `sc delete OCButtonService`
